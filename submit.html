<!DOCTYPE html>
<html>
<head>
    <title>投稿新作</title>
    <link rel="stylesheet" href="styles.css"> 
    <script>
        async function saveToGitHub() {
            const title = document.getElementById("title").value; 
            const content = document.getElementById("content").value; 
            const category = document.getElementById("category").value; 
            
            // 获取GitHub Token 
            const token = localStorage.getItem('githubToken')  || 
                          prompt('请输入GitHub Token:');
            localStorage.setItem('githubToken',  token);
 
            // 发送数据到GitHub 
            const response = await fetch(
                'https://api.github.com/repos/ 您的账号/my-poetry/contents/articles/' + 
                Date.now()  + '.json',
                {
                    method: 'PUT',
                    headers: {
                        'Authorization': 'token ' + token,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        message: 'Add new article',
                        content: btoa(unescape(encodeURIComponent(
                            JSON.stringify({title,  content, category})
                        )))
                    })
                }
            );
            
            if(response.ok)  {
                alert('投稿成功！已存储到GitHub');
                location.href  = 'index.html'; 
            } else {
                alert('提交失败，请检查Token权限');
            }
        }
    </script>
</head>
<body>
    <!-- 表单部分与之前相同 -->
    <form onsubmit="saveToGitHub(); return false;">
        <!-- 保持原有表单结构 -->
    </form>
</body>
</html>